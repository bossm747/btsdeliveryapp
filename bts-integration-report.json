{
  "summary": {
    "totalSheets": 30,
    "schemasGenerated": 8,
    "businessRules": 12,
    "seedRecords": 38,
    "featuresPlanned": 4
  },
  "schemas": {
    "riders": {
      "tableName": "bts_riders",
      "purpose": "Comprehensive rider management with attendance and performance tracking",
      "columns": {
        "id": "serial PRIMARY KEY",
        "rider_name": "varchar(100) NOT NULL",
        "rider_code": "varchar(20) UNIQUE",
        "phone_number": "varchar(20)",
        "email": "varchar(255)",
        "status": "varchar(20) DEFAULT 'active'",
        "hire_date": "date",
        "vehicle_type": "varchar(50)",
        "license_number": "varchar(50)",
        "emergency_contact": "varchar(100)",
        "emergency_phone": "varchar(20)",
        "base_salary": "decimal(10,2)",
        "commission_rate": "decimal(5,4) DEFAULT 0.02",
        "is_active": "boolean DEFAULT true",
        "created_at": "timestamp DEFAULT CURRENT_TIMESTAMP",
        "updated_at": "timestamp DEFAULT CURRENT_TIMESTAMP"
      },
      "businessRules": [
        "Each rider has unique rider code for tracking",
        "Commission rate of 0.02 (2%) based on sales remit data",
        "Status tracking: active, inactive, suspended",
        "Emergency contact required for safety"
      ]
    },
    "sales_remittance": {
      "tableName": "bts_sales_remittance",
      "purpose": "Daily sales tracking and remittance management with late payment tracking",
      "columns": {
        "id": "serial PRIMARY KEY",
        "rider_id": "integer REFERENCES bts_riders(id)",
        "remit_date": "date NOT NULL",
        "daily_sales": "decimal(10,2) DEFAULT 0",
        "commission_amount": "decimal(10,2) DEFAULT 0",
        "remitted_amount": "decimal(10,2) DEFAULT 0",
        "balance": "decimal(10,2) DEFAULT 0",
        "is_late": "boolean DEFAULT false",
        "late_days": "integer DEFAULT 0",
        "reference_number": "varchar(50)",
        "payment_method": "varchar(30)",
        "remarks": "text",
        "week_period": "varchar(20)",
        "created_at": "timestamp DEFAULT CURRENT_TIMESTAMP",
        "updated_at": "timestamp DEFAULT CURRENT_TIMESTAMP"
      },
      "businessRules": [
        "Daily sales tracking per rider",
        "Automatic commission calculation (2%)",
        "Late remittance tracking with penalty system",
        "Weekly period grouping (jan 4-jan 10 format)",
        "Reference number for payment verification"
      ]
    },
    "late_remittance": {
      "tableName": "bts_late_remittance",
      "purpose": "Track late payments and penalties",
      "columns": {
        "id": "serial PRIMARY KEY",
        "rider_id": "integer REFERENCES bts_riders(id)",
        "original_remit_id": "integer REFERENCES bts_sales_remittance(id)",
        "late_amount": "decimal(10,2) NOT NULL",
        "penalty_amount": "decimal(10,2) DEFAULT 0",
        "days_late": "integer NOT NULL",
        "paid_date": "date",
        "reference_number": "varchar(50)",
        "status": "varchar(20) DEFAULT 'pending'",
        "created_at": "timestamp DEFAULT CURRENT_TIMESTAMP"
      }
    },
    "attendance": {
      "tableName": "bts_attendance",
      "purpose": "Daily attendance tracking for all staff including riders and admins",
      "columns": {
        "id": "serial PRIMARY KEY",
        "employee_id": "integer",
        "employee_type": "varchar(20) NOT NULL",
        "attendance_date": "date NOT NULL",
        "shift_type": "varchar(20)",
        "hours_worked": "decimal(4,2) DEFAULT 0",
        "overtime_hours": "decimal(4,2) DEFAULT 0",
        "status": "varchar(20) DEFAULT 'present'",
        "check_in_time": "time",
        "check_out_time": "time",
        "break_hours": "decimal(4,2) DEFAULT 0",
        "notes": "text",
        "approved_by": "integer",
        "created_at": "timestamp DEFAULT CURRENT_TIMESTAMP"
      },
      "businessRules": [
        "Daily attendance tracking for riders and admin staff",
        "Shift types: OPENING, CLOSING, HALFDAY, OTC (On-The-Clock)",
        "Overtime calculation and tracking",
        "Flexible hours system (3hrs, 5hrs, etc.)",
        "Weekly attendance summary generation"
      ]
    },
    "payroll": {
      "tableName": "bts_payroll",
      "purpose": "Payroll calculation based on attendance and sales performance",
      "columns": {
        "id": "serial PRIMARY KEY",
        "employee_id": "integer NOT NULL",
        "employee_type": "varchar(20) NOT NULL",
        "pay_period_start": "date NOT NULL",
        "pay_period_end": "date NOT NULL",
        "regular_hours": "decimal(6,2) DEFAULT 0",
        "overtime_hours": "decimal(6,2) DEFAULT 0",
        "base_pay": "decimal(10,2) DEFAULT 0",
        "overtime_pay": "decimal(10,2) DEFAULT 0",
        "commission_earnings": "decimal(10,2) DEFAULT 0",
        "incentive_earnings": "decimal(10,2) DEFAULT 0",
        "deductions": "decimal(10,2) DEFAULT 0",
        "net_pay": "decimal(10,2) DEFAULT 0",
        "status": "varchar(20) DEFAULT 'pending'",
        "paid_date": "date",
        "created_at": "timestamp DEFAULT CURRENT_TIMESTAMP"
      }
    },
    "incentives": {
      "tableName": "bts_incentives",
      "purpose": "Performance-based incentives and raffle system for riders",
      "columns": {
        "id": "serial PRIMARY KEY",
        "rider_id": "integer REFERENCES bts_riders(id)",
        "incentive_period": "varchar(30) NOT NULL",
        "performance_score": "decimal(8,2) DEFAULT 0",
        "sales_target": "decimal(10,2) DEFAULT 0",
        "sales_achieved": "decimal(10,2) DEFAULT 0",
        "target_percentage": "decimal(5,2) DEFAULT 0",
        "incentive_amount": "decimal(10,2) DEFAULT 0",
        "raffle_entries": "integer DEFAULT 0",
        "raffle_won": "boolean DEFAULT false",
        "raffle_prize": "varchar(100)",
        "bonus_amount": "decimal(10,2) DEFAULT 0",
        "payment_status": "varchar(20) DEFAULT 'pending'",
        "paid_date": "date",
        "created_at": "timestamp DEFAULT CURRENT_TIMESTAMP"
      },
      "businessRules": [
        "Bi-weekly incentive periods (15-day cycles)",
        "Performance-based incentive calculation",
        "Raffle system with multiple entries based on performance",
        "Sales target achievement tracking",
        "Automatic incentive calculation and payout tracking"
      ]
    },
    "audit_reports": {
      "tableName": "bts_audit_reports",
      "purpose": "Comprehensive audit trail and reporting system",
      "columns": {
        "id": "serial PRIMARY KEY",
        "report_type": "varchar(50) NOT NULL",
        "report_period": "varchar(30) NOT NULL",
        "rider_id": "integer REFERENCES bts_riders(id)",
        "total_sales": "decimal(12,2) DEFAULT 0",
        "declared_sales": "decimal(12,2) DEFAULT 0",
        "undeclared_sales": "decimal(12,2) DEFAULT 0",
        "discrepancy_amount": "decimal(12,2) DEFAULT 0",
        "audit_status": "varchar(20) DEFAULT 'pending'",
        "audit_notes": "text",
        "audited_by": "integer",
        "audit_date": "date NOT NULL",
        "resolution_date": "date",
        "created_at": "timestamp DEFAULT CURRENT_TIMESTAMP"
      }
    },
    "undeclared_bookings": {
      "tableName": "bts_undeclared_bookings",
      "purpose": "Track undeclared or missing booking records",
      "columns": {
        "id": "serial PRIMARY KEY",
        "rider_id": "integer REFERENCES bts_riders(id)",
        "booking_date": "date NOT NULL",
        "estimated_amount": "decimal(10,2)",
        "actual_amount": "decimal(10,2)",
        "discrepancy_reason": "varchar(100)",
        "status": "varchar(20) DEFAULT 'flagged'",
        "explanation": "text",
        "resolved_by": "integer",
        "resolved_date": "date",
        "created_at": "timestamp DEFAULT CURRENT_TIMESTAMP"
      }
    }
  },
  "businessRules": [
    {
      "rule": "Standard Commission Rate",
      "description": "2% commission on all sales (0.02 factor found in data)",
      "implementation": "commission = sales_amount * 0.02",
      "priority": "HIGH"
    },
    {
      "rule": "Daily Sales Remittance",
      "description": "Riders must remit daily sales with commission deducted",
      "implementation": "remit_amount = sales_amount - commission_amount",
      "priority": "HIGH"
    },
    {
      "rule": "Weekly Remittance Periods",
      "description": "Sales tracked in weekly periods (e.g., jan 4-jan 10)",
      "implementation": "Weekly grouping for easier management and reconciliation",
      "priority": "MEDIUM"
    },
    {
      "rule": "Flexible Shift System",
      "description": "Multiple shift types: OPENING, CLOSING, HALFDAY, OTC",
      "implementation": "Configurable shift types with different hour calculations",
      "priority": "HIGH"
    },
    {
      "rule": "Overtime Tracking",
      "description": "Track overtime hours separately (e.g., \"11 hrs ot\")",
      "implementation": "overtime_pay = overtime_hours * hourly_rate * 1.5",
      "priority": "MEDIUM"
    },
    {
      "rule": "Part-time Schedules",
      "description": "Support for 3hrs, 5hrs, and other flexible schedules",
      "implementation": "Flexible hour tracking per shift type",
      "priority": "MEDIUM"
    },
    {
      "rule": "Bi-weekly Incentive Cycles",
      "description": "15-day incentive periods (JAN 1-JAN 15, JAN 16-JAN 31)",
      "implementation": "Calculate incentives every 15 days based on performance",
      "priority": "HIGH"
    },
    {
      "rule": "Performance-based Raffle",
      "description": "Better performance = more raffle entries",
      "implementation": "raffle_entries = performance_score / threshold",
      "priority": "MEDIUM"
    },
    {
      "rule": "Sales Target System",
      "description": "Set targets per rider with achievement tracking",
      "implementation": "achievement_rate = actual_sales / target_sales",
      "priority": "HIGH"
    },
    {
      "rule": "Late Remittance Tracking",
      "description": "Track late payments with reference numbers and dates",
      "implementation": "Auto-flag late remittances and calculate penalties",
      "priority": "HIGH"
    },
    {
      "rule": "Audit Trail Requirements",
      "description": "Every transaction must have reference numbers and documentation",
      "implementation": "Mandatory reference numbers for all financial transactions",
      "priority": "HIGH"
    },
    {
      "rule": "Undeclared Booking Detection",
      "description": "System to detect and flag undeclared bookings",
      "implementation": "Compare actual vs expected sales patterns",
      "priority": "MEDIUM"
    }
  ],
  "seedData": {
    "riders": [
      {
        "id": 1,
        "rider_name": "ADRIAN",
        "rider_code": "R001",
        "status": "active",
        "hire_date": "2024-01-01",
        "commission_rate": 0.02,
        "is_active": true
      },
      {
        "id": 2,
        "rider_name": "ALFREDO",
        "rider_code": "R002",
        "status": "active",
        "hire_date": "2024-01-01",
        "commission_rate": 0.02,
        "is_active": true
      },
      {
        "id": 3,
        "rider_name": "CHANO",
        "rider_code": "R003",
        "status": "active",
        "hire_date": "2024-01-01",
        "commission_rate": 0.02,
        "is_active": true
      },
      {
        "id": 4,
        "rider_name": "DAYO",
        "rider_code": "R004",
        "status": "active",
        "hire_date": "2024-01-01",
        "commission_rate": 0.02,
        "is_active": true
      },
      {
        "id": 5,
        "rider_name": "DAVE",
        "rider_code": "R005",
        "status": "active",
        "hire_date": "2024-01-01",
        "commission_rate": 0.02,
        "is_active": true
      }
    ],
    "sales": [
      {
        "rider_name": "ADRIAN",
        "date": "2025-01-21",
        "daily_sales": 455,
        "commission_amount": 9.1,
        "week_period": "jan 21-jan 27"
      },
      {
        "rider_name": "ADRIAN",
        "date": "2025-01-22",
        "daily_sales": 528,
        "commission_amount": 10.56,
        "week_period": "jan 21-jan 27"
      },
      {
        "rider_name": "ADRIAN",
        "date": "2025-01-23",
        "daily_sales": 565,
        "commission_amount": 11.3,
        "week_period": "jan 21-jan 27"
      },
      {
        "rider_name": "ADRIAN",
        "date": "2025-01-24",
        "daily_sales": 720,
        "commission_amount": 14.4,
        "week_period": "jan 21-jan 27"
      },
      {
        "rider_name": "ADRIAN",
        "date": "2025-01-25",
        "daily_sales": 390,
        "commission_amount": 7.8,
        "week_period": "jan 21-jan 27"
      },
      {
        "rider_name": "ADRIAN",
        "date": "2025-01-26",
        "daily_sales": 625,
        "commission_amount": 12.5,
        "week_period": "jan 21-jan 27"
      },
      {
        "rider_name": "ADRIAN",
        "date": "2025-01-27",
        "daily_sales": 185,
        "commission_amount": 3.7,
        "week_period": "jan 21-jan 27"
      },
      {
        "rider_name": "ALFREDO",
        "date": "2025-01-21",
        "daily_sales": 785,
        "commission_amount": 15.700000000000001,
        "week_period": "jan 21-jan 27"
      },
      {
        "rider_name": "ALFREDO",
        "date": "2025-01-22",
        "daily_sales": 833,
        "commission_amount": 16.66,
        "week_period": "jan 21-jan 27"
      },
      {
        "rider_name": "ALFREDO",
        "date": "2025-01-23",
        "daily_sales": 300,
        "commission_amount": 6,
        "week_period": "jan 21-jan 27"
      },
      {
        "rider_name": "ALFREDO",
        "date": "2025-01-25",
        "daily_sales": 130,
        "commission_amount": 2.6,
        "week_period": "jan 21-jan 27"
      },
      {
        "rider_name": "ALFREDO",
        "date": "2025-01-26",
        "daily_sales": 685,
        "commission_amount": 13.700000000000001,
        "week_period": "jan 21-jan 27"
      },
      {
        "rider_name": "ALFREDO",
        "date": "2025-01-27",
        "daily_sales": 820,
        "commission_amount": 16.4,
        "week_period": "jan 21-jan 27"
      },
      {
        "rider_name": "CHANO",
        "date": "2025-01-22",
        "daily_sales": 565,
        "commission_amount": 11.3,
        "week_period": "jan 21-jan 27"
      },
      {
        "rider_name": "DAVE",
        "date": "2025-01-21",
        "daily_sales": 221,
        "commission_amount": 4.42,
        "week_period": "jan 21-jan 27"
      },
      {
        "rider_name": "DAVE",
        "date": "2025-01-22",
        "daily_sales": 303,
        "commission_amount": 6.0600000000000005,
        "week_period": "jan 21-jan 27"
      },
      {
        "rider_name": "DAVE",
        "date": "2025-01-23",
        "daily_sales": 236,
        "commission_amount": 4.72,
        "week_period": "jan 21-jan 27"
      },
      {
        "rider_name": "DAVE",
        "date": "2025-01-24",
        "daily_sales": 65,
        "commission_amount": 1.3,
        "week_period": "jan 21-jan 27"
      },
      {
        "rider_name": "DAVE",
        "date": "2025-01-27",
        "daily_sales": 475,
        "commission_amount": 9.5,
        "week_period": "jan 21-jan 27"
      }
    ],
    "attendance": [
      {
        "employee_name": "BADETH",
        "date": "2025-01-21",
        "shift_type": "OTC",
        "hours_worked": 8,
        "status": "present"
      },
      {
        "employee_name": "BADETH",
        "date": "2025-01-22",
        "shift_type": "OTC",
        "hours_worked": 8,
        "status": "present"
      },
      {
        "employee_name": "BADETH",
        "date": "2025-01-23",
        "shift_type": "HALFDAY",
        "hours_worked": 4,
        "status": "present"
      },
      {
        "employee_name": "BADETH",
        "date": "2025-01-24",
        "shift_type": "OFF",
        "hours_worked": 0,
        "status": "absent"
      },
      {
        "employee_name": "BADETH",
        "date": "2025-01-25",
        "shift_type": "CLOSING",
        "hours_worked": 8,
        "status": "present"
      },
      {
        "employee_name": "BADETH",
        "date": "2025-01-26",
        "shift_type": "OPENING",
        "hours_worked": 8,
        "status": "present"
      },
      {
        "employee_name": "BADETH",
        "date": "2025-01-27",
        "shift_type": "OPENING",
        "hours_worked": 8,
        "status": "present"
      },
      {
        "employee_name": "NIKITA",
        "date": "2025-01-21",
        "shift_type": "OTC",
        "hours_worked": 8,
        "status": "present"
      },
      {
        "employee_name": "NIKITA",
        "date": "2025-01-22",
        "shift_type": "OTC",
        "hours_worked": 8,
        "status": "present"
      },
      {
        "employee_name": "NIKITA",
        "date": "2025-01-23",
        "shift_type": "HALFDAY",
        "hours_worked": 4,
        "status": "present"
      },
      {
        "employee_name": "NIKITA",
        "date": "2025-01-24",
        "shift_type": "CLOSING",
        "hours_worked": 8,
        "status": "present"
      },
      {
        "employee_name": "NIKITA",
        "date": "2025-01-25",
        "shift_type": "OFF",
        "hours_worked": 0,
        "status": "absent"
      },
      {
        "employee_name": "NIKITA",
        "date": "2025-01-26",
        "shift_type": "CLOSING",
        "hours_worked": 8,
        "status": "present"
      },
      {
        "employee_name": "NIKITA",
        "date": "2025-01-27",
        "shift_type": "CLOSING",
        "hours_worked": 8,
        "status": "present"
      }
    ],
    "queries": {
      "rider_performance": "\n        SELECT \n          r.rider_name,\n          COUNT(sr.id) as total_days,\n          SUM(sr.daily_sales) as total_sales,\n          SUM(sr.commission_amount) as total_commission,\n          AVG(sr.daily_sales) as avg_daily_sales\n        FROM bts_riders r\n        LEFT JOIN bts_sales_remittance sr ON r.id = sr.rider_id\n        WHERE sr.remit_date >= '2025-01-01'\n        GROUP BY r.id, r.rider_name\n        ORDER BY total_sales DESC;\n      ",
      "attendance_summary": "\n        SELECT \n          employee_name,\n          COUNT(*) as total_days,\n          SUM(CASE WHEN status = 'present' THEN 1 ELSE 0 END) as days_present,\n          SUM(hours_worked) as total_hours,\n          AVG(hours_worked) as avg_daily_hours\n        FROM bts_attendance\n        WHERE attendance_date >= '2025-01-01'\n        GROUP BY employee_name\n        ORDER BY total_hours DESC;\n      ",
      "late_remittance_report": "\n        SELECT \n          r.rider_name,\n          lr.late_amount,\n          lr.days_late,\n          lr.status,\n          sr.week_period\n        FROM bts_late_remittance lr\n        JOIN bts_riders r ON lr.rider_id = r.id\n        JOIN bts_sales_remittance sr ON lr.original_remit_id = sr.id\n        WHERE lr.status = 'pending'\n        ORDER BY lr.days_late DESC;\n      "
    }
  },
  "features": [
    {
      "name": "BTS Admin Dashboard",
      "description": "Comprehensive admin panel matching current BTS operations",
      "components": [
        {
          "name": "Sales Overview Widget",
          "purpose": "Daily/weekly sales summary with remittance tracking",
          "dataSource": "bts_sales_remittance table",
          "features": [
            "Real-time sales totals",
            "Commission calculations",
            "Late remittance alerts"
          ]
        },
        {
          "name": "Rider Performance Widget",
          "purpose": "Top performers, attendance rates, incentive standings",
          "dataSource": "Multiple tables (riders, sales, attendance, incentives)",
          "features": [
            "Performance rankings",
            "Attendance percentages",
            "Incentive tracking"
          ]
        },
        {
          "name": "Attendance Monitor",
          "purpose": "Real-time attendance tracking for all staff",
          "dataSource": "bts_attendance table",
          "features": [
            "Live attendance status",
            "Shift schedules",
            "Overtime alerts"
          ]
        },
        {
          "name": "Financial Reports",
          "purpose": "Revenue, commissions, payroll, and audit reports",
          "dataSource": "All financial tables",
          "features": [
            "Monthly P&L",
            "Commission summaries",
            "Audit trails"
          ]
        }
      ]
    },
    {
      "name": "BTS Rider Management System",
      "description": "Complete rider lifecycle management",
      "components": [
        {
          "name": "Rider Profile Management",
          "purpose": "Comprehensive rider information and document management",
          "features": [
            "Personal details",
            "Vehicle information",
            "License tracking",
            "Emergency contacts"
          ]
        },
        {
          "name": "Daily Sales Entry",
          "purpose": "Mobile-friendly sales reporting for riders",
          "features": [
            "Quick sales entry",
            "Photo receipts",
            "Commission calculation",
            "Remittance tracking"
          ]
        },
        {
          "name": "Attendance Tracking",
          "purpose": "Clock in/out system with shift management",
          "features": [
            "GPS location verification",
            "Shift type selection",
            "Break tracking",
            "Overtime calculation"
          ]
        },
        {
          "name": "Performance Dashboard",
          "purpose": "Rider-specific performance metrics and incentives",
          "features": [
            "Sales targets",
            "Achievement tracking",
            "Incentive status",
            "Raffle entries"
          ]
        }
      ]
    },
    {
      "name": "BTS Integrated Payroll System",
      "description": "Automated payroll based on attendance and performance",
      "components": [
        {
          "name": "Automated Payroll Calculation",
          "purpose": "Calculate pay based on attendance, sales, and incentives",
          "features": [
            "Base salary + commission",
            "Overtime calculations",
            "Incentive bonuses",
            "Deduction tracking"
          ]
        },
        {
          "name": "Payslip Generation",
          "purpose": "Digital payslips with detailed breakdown",
          "features": [
            "PDF payslips",
            "Breakdown by category",
            "YTD summaries",
            "Tax calculations"
          ]
        },
        {
          "name": "Incentive Management",
          "purpose": "Automated incentive and raffle system",
          "features": [
            "Performance-based calculations",
            "Raffle entry tracking",
            "Prize distribution",
            "Payout scheduling"
          ]
        }
      ]
    },
    {
      "name": "BTS Advanced Reporting System",
      "description": "Comprehensive reporting matching current Excel system",
      "components": [
        {
          "name": "Operational Reports",
          "purpose": "Daily, weekly, and monthly operational reports",
          "features": [
            "Sales summaries",
            "Rider performance",
            "Attendance reports",
            "Commission tracking"
          ]
        },
        {
          "name": "Audit Reports",
          "purpose": "Audit trails and discrepancy detection",
          "features": [
            "Undeclared booking detection",
            "Late remittance tracking",
            "Financial reconciliation",
            "Compliance reports"
          ]
        },
        {
          "name": "Excel Export Compatibility",
          "purpose": "Export reports in Excel format matching current templates",
          "features": [
            "Template matching",
            "Formatted exports",
            "Historical data",
            "Comparative analysis"
          ]
        }
      ]
    }
  ],
  "generatedAt": "2025-08-29T14:21:06.557Z"
}